{% extends "user-admin.html" %}


{% block 'content' %}
{% load filt%}
{% load patient%}
<!-- <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css"> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<div class="d-flex  justify-content-center align-items-center h-100 w-100">
 
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


{% if messages %}
       
          
{% for message in messages %}
     {% if message.tags == 'error'%}
         <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
         <script>
             var m="{{message}}";
             console.log(m);
             Swal.fire({
                     position: 'center',
                     icon: 'error',
                     title: m,
                     showConfirmButton: false,
                     timer: 3000
                     })
            </script>
            {%endif%}
     {% if message.tags == 'success'%}
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script>
                var m="{{message}}";
                console.log(m);
                Swal.fire({
                        position: 'center',
                        icon: 'success',
                        title: m,
                        showConfirmButton: false,
                        timer: 7000
                        })
               </script>
               {%endif%}       
{% endfor %}
{%endif%}     <div class="card bg-transBody p-5" style="width: 90%; height: 90%;">   
                

                <form action="{% url 'patient:d_order' id=id %}" method="post" class="checkout__form">{%csrf_token%}  
                  <div class="row d-flex  justify-content-center ">
                    <div class="col-lg-8 col-sm-6 ">
                      <h5 class="text-center text-transform">Billing detail</h5> 
                      <div class="card p-2 bg-transBody">
                        <div class="d-flex justify-content-between p-0">
                          <h5 class="ml-4 p-0">Address</h5>
                          <a href="{% url 'patient:adres' id=id %}" class="float-right p-0"><i class="bi bi-plus-lg  mr-4"></i></a>
                        </div>
                        {%if adress%}  
                   
                          {% for ads in adress %}
                            <div class="card" style="background-color: transparent; border: none;"> 
                                <div class="row">
                                  <div class="col-1 pt-2">
                                      <input type="radio" name="address" id="address{{ ads.id }}" value="{{ ads.id }}" required>
                                      <label for="address{{ ads.id }}"></label>
                                  </div>
                                  <div class="col-11">

                                  <div class="d-flex justify-content-between">
                                    <div>
                                      {{ ads.address }}<br>{{ ads.city }}<br>{{ ads.state }}<br>{{ ads.Pin_code }}

                                    </div>
                                    <div class="d-flex flex-column justify-content-end" >
                                      <a href="{% url 'patient:edit_adres' ads.id id %}" class="float-right px-1"><i class="fa fa-pencil" aria-hidden="true"></i></a>
                                      <a href="{% url 'patient:delete_adres' ads.id id %}" class="float-right "><i class="fa fa-trash" aria-hidden="true"></i></a>                                                      
                                    </div>
                                  </div>  
                                  </div>
                                </div>
                            </div>   
                          {% endfor %}
                        {%endif%}
                      </div>
                    </div>    
                    <div class="col-lg-4 col-sm-6 ">
                      <div class="card mt-4 p-4 bg-transBody">
                        <h5 class="text-center">Your order</h5>
                        <div class="">
                                {% for i in list%}
                                    <h6 name="product" class="ml-3">{{i.medicine}} <span name="total" class="text-dark float-right mr-2">$ {{i.medicine.price|ttl:i.quantity}}</span></h6>   
                                {%endfor%} 
                        </div>
                        <div class="">
                                {% if request.session.coupen %}
                                  <h5 class="ml-3 mt-2 mb-2">Total <span class="float-right mr-2  ">$ {{money}}</span></h5>
                                  <h5 class="ml-3 mt-2 mb-2">Discount Price<span class="float-right">$ {{request.session.coupen|discount}}<a href="{% url 'patient:delet_coupen' id=id %}" class="bg-light rounded"><i class="text-white bi bi-x"></i></a></span></h5>
                                  <h5 class="ml-3 mt-2 mb-2">Total <span class="float-right mr-2  ">$ {{money|summery:request.session.coupen}}</span></h5> 
                                {%else%}
                                
                                   <h5 class="ml-3 mt-2 mb-2">Total <span class="float-right mr-2  ">$ {{money}}</span></h5>
                                {%endif%}            
                        
                        </div>

                        <div class="ml-3">
                            <input type="radio" name="payment" id="cash" value="cash"   required>
                            <label for="cash">Cash on delivery</label><br>
                            <input type="radio" name="payment" id="online" value="online" required>
                            <label for="online">Online Payment</label><br>
                            {% if request.session.coupen %}
                               <input type="radio" name="payment" id="wallet" value="wallet" {% if money|summery:request.session.coupen > walt %} disabled {%endif%} required>
                            {%else%}
                              <input type="radio" name="payment" id="wallet" value="wallet" {% if money > walt %} disabled {%endif%} required>
                              
                            {%endif%}
                            <label for="wallet">wallet</label>  
                               
                        </div>
                        
                        <div class="checkout__order__widget ml-3">
                            <input type="checkbox" id="paypal">
                            <label for="paypal">
                                PayPal
                            </label>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-ligth text-success w-50">Place oder</button>

                        </div>
                      </div>
                    </div>
                  </div>  
                </form>
                <div class="card col-xl-4 col-lg-6 col-sm-10 col-xs-12 bg-transBody discbody">
                  <h4 class="coupen_data text-center">coupen codes</h4>
                  <div class="d-flex flex-column align-item-center p-3 disc" style=" animation-duration: 5s;">
                    <form action="{% url 'patient:copn' id=id %}" method="post">
                        {%csrf_token%}
                        <input type="text" class="border border-0 rounded-4 px-3  w-100 pl-5 bg-transBody" 
                        style="height:40px;outline: none;" name="coupon" placeholder="Enter your coupon code">
                        <div class="py-2 mx-2">
                            <button class="btn bg-transBody" type="submit" class="dibut">Apply</button>
                        </div>
                    </form>
                  </div>  
                </div>   
              </div>  
        <script>
          //  const coupenShow=document.querySelector('.disc')

          // window.addEventListener('load', function(){
          //   coupenShow.classList.add('d-none')
          // });
    
           $(document).ready(function(){
            const $coupenShow = $('.disc');
            $coupenShow.addClass('d-none'); 
             $(".coupen_data").click(function () {
            if ($coupenShow.hasClass('d-none')) {
              $coupenShow.fadeIn('slow').removeClass('d-none')
            } else {
                $coupenShow.fadeOut('slow').addClass('d-none')
            }
            });

         });   
       </script>
  </div>


 {%endblock%}   